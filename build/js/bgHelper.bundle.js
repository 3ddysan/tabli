webpackJsonp([0],{0:function(n,e,o){"use strict";function t(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e["default"]=n,e}function r(n){return n&&n.__esModule?n:{"default":n}}function i(n,e){for(var o=[],t=0;t<e.children.length;t++){var r=e.children[t];if("_"!==r.title[0]){var i=r.children;i?o.push(W.makeFolderTabWindow(r)):console.log("Found bookmarks folder with no children, skipping: ",i)}}return n.registerTabWindows(o)}function a(n,e,o){if(n.children)for(var t=0;t<n.children.length;t++){var r=n.children[t];if(r.title.toLowerCase()===e.toLowerCase())return o(r),!0}console.log("Child folder ",e," Not found, creating...");var i={parentId:n.id,title:e};chrome.bookmarks.create(i,o)}function d(n){var e=null,o=null;chrome.bookmarks.getTree(function(t){var r=t[0].children[1];a(r,B,function(t){console.log("tab manager folder acquired."),e=t.id,a(t,R,function(r){console.log("archive folder acquired."),o=r.id,chrome.bookmarks.getSubTree(t.id,function(t){var r=new k({folderId:e,archiveFolderId:o}),a=i(r,t[0]);n(a)})})})})}function c(n){chrome.runtime.onConnect.addListener(function(e){e.onMessage.addListener(function(o){var t=o.listenerId;e.onDisconnect.addListener(function(){n.removeViewListener(t)})})})}function u(n,e,o){n(function(n){var t=n.getTabWindowByChromeId(e.windowId);if(!t)return console.warn("tabs.onCreated: window id not found: ",e.windowId),n;var r=n.handleTabCreated(t,e),i=r.getTabWindowByChromeId(e.windowId),a=o?r.handleTabActivated(i,e.id):r;return a})}function s(n,e,o){n(function(n){var t=n.getTabWindowByChromeId(e);return t?n.handleTabClosed(t,o):(console.warn("tabs.onTabRemoved: window id not found: ",e),n)})}function f(n){chrome.windows.onRemoved.addListener(function(e){n(function(n){var o=n.getTabWindowByChromeId(e),t=o?n.handleTabWindowClosed(o):n;return t})}),chrome.windows.onCreated.addListener(function(e){n(function(n){return n.syncChromeWindow(e)})}),chrome.windows.onFocusChanged.addListener(function(e){e!==chrome.windows.WINDOW_ID_NONE&&n(function(n){return n.setCurrentWindowId(e)})},{windowTypes:["normal"]}),chrome.tabs.onCreated.addListener(function(e){return u(n,e)}),chrome.tabs.onUpdated.addListener(function(e,o,t){n(function(n){var r=n.getTabWindowByChromeId(t.windowId);return r?n.handleTabUpdated(r,e,o):(console.warn("tabs.onUpdated: window id not found: ",t.windowId),n)})}),chrome.tabs.onActivated.addListener(function(e){n(function(n){var o=n.getTabWindowByChromeId(e.windowId);if(!o)return console.warn("tabs.onActivated: window id not found: ",e.windowId,e),n;var t=o?n.handleTabActivated(o,e.tabId):n;return t})}),chrome.tabs.onRemoved.addListener(function(e,o){o.isWindowClosing||s(n,o.windowId,e)}),chrome.tabs.onReplaced.addListener(function(e,o){n(function(t){var r=t.getTabWindowByChromeTabId(o);if(!r)return console.warn("tabs.onReplaced: could not find window for removed tab: ",o),t;var i=t.handleTabClosed(r,o);return chrome.tabs.get(e,function(e){return u(n,e)}),i})}),chrome.tabs.onMoved.addListener(function(e,o){y.syncChromeWindowById(o.windowId,n)}),chrome.tabs.onDetached.addListener(function(e,o){s(n,o.oldWindowId,e)}),chrome.tabs.onAttached.addListener(function(e,o){chrome.tabs.get(e,function(e){return u(n,e,!0)})}),chrome.browserAction.onClicked.addListener(function(e){console.log("broswerAction: clicked!"),n(function(n){return y.showPopout(n),n})})}function l(n,e){var o=.4,t=n.getUrlBookmarkIdMap(),r=T.Record({windowId:-1,matches:T.Map(),bestMatch:null,tabCount:0});chrome.windows.getAll({populate:!0},function(i){function a(e){function i(e,t){var r=n.bookmarkIdMap.get(t),i=r.tabItems.count(),a=e/i;return a>=o}var a=e.tabs.map(function(n){return t.get(n.url,null)}).filter(function(n){return n}),d=a.map(function(n){return n.countBy(function(n){return n})}),c=function(n,e){return n.mergeWith(function(n,e){return n+e},e)},u=d.reduce(c,T.Map()),s=u.filter(i),f=S.bestMatch(s);return new r({windowId:e.id,matches:u,bestMatch:f,tabCount:e.tabs.length})}var d=T.Seq(i).map(a).filter(function(n){return n.bestMatch}),c=d.groupBy(function(n){return n.bestMatch});console.log("bmMatches: ",c.toJS());var u=c.map(function(n){var e=n.map(function(n){var e=n.matches.get(n.bestMatch);return[n.windowId,e]});return T.Map(e)});console.log("bmMatchMaps: ",u.toJS());var s=u.map(function(n){return S.bestMatch(n)}).filter(function(n){return n});console.log("bestBMMatches: ",s.toJS());var f=g.fromPairs(i.map(function(n){return[n.id,n]})),l=function(n,e,o){var t=f[e],r=n.bookmarkIdMap.get(o),i=n.attachChromeWindow(r,t);return i},w=s.reduce(l,n);e(w)})}function w(){d(function(n){l(n,function(n){console.log("init: done reading bookmarks and re-attaching: ",n.toJS()),chrome.windows.getCurrent(null,function(e){console.log("bgHelper: currentWindow: ",e),y.syncChromeWindows(function(o){console.log("initial sync of chrome windows complete.");var t=o(n).setCurrentWindow(e);console.log("window ids in store: ",g.keys(t.windowIdMap.toJS())),console.log("current window after initial sync: ",t.currentWindowId,t.getCurrentWindow()),window.storeRef=new L(t),c(window.storeRef);var r=(0,M.refUpdater)(window.storeRef);f(r),y.closePopout(window.storeRef.getValue(),function(n){r(n),y.showPopout(window.storeRef.getValue(),r)})})})})})}var h=o(1),m=(r(h),o(2)),b=t(m),p=o(4),g=t(p),v=o(6),T=t(v),I=o(9),C=(t(I),o(197)),M=(t(C),o(42)),k=b.TabManagerState,W=b.TabWindow,y=(b.components.Popup,b.actions),L=b.ViewRef,S=b.utils,B="Tabli Saved Windows",R="_Archive";w()},1:function(n,e){"use strict";var o={activateTab:function(n,e){chrome.tabs.update(n,{active:!0},e)},setFocusedWindow:function(n,e){chrome.windows.update(n,{focused:!0},e)}};window.tabliBrowser=o,n.exports=o},197:function(n,e,o){"use strict";n.exports=o(198)},198:function(n,e,o){"use strict";var t=o(68),r=o(199),i=o(37);t.inject();var a={renderToString:r.renderToString,renderToStaticMarkup:r.renderToStaticMarkup,version:i};n.exports=a},199:function(n,e,o){"use strict";function t(n,e){var o;try{return l.injection.injectBatchingStrategy(s),o=f.getPooled(e),o.perform(function(){var t=h(n),r=t.mountComponent(o,null,a(),w);return e||(r=u.addChecksumToMarkup(r)),r},null)}finally{f.release(o),l.injection.injectBatchingStrategy(d)}}function r(n){return c.isValidElement(n)?void 0:m(!1),t(n,!1)}function i(n){return c.isValidElement(n)?void 0:m(!1),t(n,!0)}var a=o(185),d=o(158),c=o(15),u=o(187),s=o(200),f=o(201),l=o(85),w=o(27),h=o(145),m=o(14);n.exports={renderToString:r,renderToStaticMarkup:i}},200:function(n,e){"use strict";var o={isBatchingUpdates:!1,batchedUpdates:function(n){}};n.exports=o},201:function(n,e,o){"use strict";function t(n){this.reinitializeTransaction(),this.renderToStaticMarkup=n,this.useCreateElement=!1}var r=o(11),i=o(13),a=o(92),d=[],c={enqueue:function(){}},u={getTransactionWrappers:function(){return d},getReactMountReady:function(){return c},destructor:function(){}};r(t.prototype,a.Mixin,u),i.addPoolingTo(t),n.exports=t}});