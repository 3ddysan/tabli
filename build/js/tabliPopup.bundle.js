webpackJsonp([3],{0:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){function t(){var t=l.createElement(v["default"],{storeRef:o,initialWinStore:r}),s=(c.render(t,i),performance.now());console.log("full render complete. render time: (",s-n," ms)"),h.syncChromeWindows((0,f.logWrap)(function(t){var s=t(r),a=s.setCurrentWindow(e);o.setValue(a);var i=performance.now();console.log("syncChromeWindows and update complete: ",i-n," ms"),document.getElementById("searchBox").focus()}))}var n=performance.now(),s=chrome.extension.getBackgroundPage(),o=s.storeRef,r=s.savedStore,a=s.savedHTML,i=document.getElementById("windowList-region");if(a){i.innerHTML=a;var d=performance.now();console.log("time to set initial HTML: ",d-n)}setTimeout(t,0)}function a(){chrome.windows.getCurrent(null,function(e){r(e.id)})}function i(){window.onload=a}var d=n(8),l=o(d),p=n(183),c=o(p),u=n(6),h=o(u),f=n(7),w=n(166),v=s(w);i()},166:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){var t=chrome.runtime.connect({name:"popup"});t.postMessage(e),t.onMessage.addListener(function(e){console.log("Got response message: ",e)})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),i=o(a),d=n(6),l=o(d),p=n(167),c=o(p),u=n(161),h=n(168),f=s(h),w=n(178),v=s(w),m=n(179),b=s(m),S=n(171),W=o(S),I=i.createClass({displayName:"Popup",storeAsState:function(e){var t=e.getAll(),n=t.sort(W.windowCmp);return{winStore:e,sortedWindows:n}},getInitialState:function(){var e=this.storeAsState(this.props.initialWinStore);return e.saveModalIsOpen=!1,e.revertModalIsOpen=!1,e.revertTabWindow=null,e.searchStr="",e.searchRE=null,e},handleSearchInput:function(e){var t=e.trim(),n=null;t.length>0&&(n=new RegExp(t,"i")),console.log("search input: '"+t+"'"),this.setState({searchStr:t,searchRE:n})},openSaveModal:function(e){var t=e.title;this.setState({saveModalIsOpen:!0,saveInitialTitle:t,saveTabWindow:e})},closeSaveModal:function(){this.setState({saveModalIsOpen:!1})},openRevertModal:function(e){this.setState({revertModalIsOpen:!0,revertTabWindow:e.tabWindow})},closeRevertModal:function(){this.setState({revertModalIsOpen:!1,revertTabWindow:null})},doSave:function(e){var t=this.props.storeRef,n=t.getValue().folderId;l.manageWindow(n,this.state.saveTabWindow,e,(0,u.refUpdater)(t)),this.closeSaveModal()},doRevert:function(e){var t=(0,u.refUpdater)(this.props.storeRef);l.revertWindow(this.state.revertTabWindow,t),this.closeRevertModal()},renderSaveModal:function(){var e=null;return this.state.saveModalIsOpen&&(e=i.createElement(v["default"],{initialTitle:this.state.saveInitialTitle,tabWindow:this.state.saveTabWindow,onClose:this.closeSaveModal,onSubmit:this.doSave,appComponent:this})),e},renderRevertModal:function(){var e=null;return this.state.revertModalIsOpen&&(e=i.createElement(f["default"],{tabWindow:this.state.revertTabWindow,onClose:this.closeRevertModal,onSubmit:this.doRevert,appComponent:this})),e},render:function(){var e;try{var t=this.renderSaveModal(),n=this.renderRevertModal(),s=c.filterTabWindows(this.state.sortedWindows,this.state.searchRE);e=i.createElement("div",null,i.createElement(b["default"],{onSearchInput:this.handleSearchInput,winStore:this.state.winStore,storeUpdateHandler:(0,u.refUpdater)(this.props.storeRef),filteredWindows:s,appComponent:this,searchStr:this.state.searchStr,searchRE:this.state.searchRE}),t,n)}catch(o){throw console.error("App Component: caught exception during render: "),console.error(o.stack),o}return e},componentWillMount:function(){var e=this;if(!this.props.noListener){var t=this.props.storeRef,n=t.addViewListener(function(){console.log("TabliPopup: viewListener: updating store from storeRef"),e.setState(e.storeAsState(t.getValue()))});r({listenerId:n})}}});t["default"]=I},179:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){var n=e.length>0?t.itemMatches.count():t.tabWindow.tabItems.count();return n}function a(e,t,n){if(0===t.length){var s=e.tabWindow,o=s.tabItems.get(n);return o}var r=e.itemMatches.get(n);return r.tabItem}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),d=o(i),l=n(169),p=s(l),c=n(171),u=o(c),h=n(6),f=o(h),w=n(180),v=s(w),m=n(181),b=s(m),S=d.createClass({displayName:"SelectablePopup",getInitialState:function(){return{selectedWindowIndex:0,selectedTabIndex:0}},handlePrevSelection:function(e){if(0!==this.props.filteredWindows.length){var t=this.props.filteredWindows[this.state.selectedWindowIndex];if(t.tabWindow.open&&this.state.selectedTabIndex>0&&!e)this.setState({selectedTabIndex:this.state.selectedTabIndex-1});else if(this.state.selectedWindowIndex>0){var n=this.state.selectedWindowIndex-1,s=this.props.filteredWindows[n],o=this.props.searchStr.length>0?s.itemMatches.count():s.tabWindow.tabItems.count();this.setState({selectedWindowIndex:n,selectedTabIndex:o-1})}}},handleNextSelection:function(e){if(0!==this.props.filteredWindows.length){var t=this.props.filteredWindows[this.state.selectedWindowIndex],n=this.props.searchStr.length>0?t.itemMatches.count():t.tabWindow.tabItems.count();t.tabWindow.open&&this.state.selectedTabIndex+1<n&&!e?this.setState({selectedTabIndex:this.state.selectedTabIndex+1}):this.state.selectedWindowIndex+1<this.props.filteredWindows.length&&this.setState({selectedWindowIndex:this.state.selectedWindowIndex+1,selectedTabIndex:0})}},handleSelectionEnter:function(){if(0!==this.props.filteredWindows.length){var e=this.props.filteredWindows[this.state.selectedWindowIndex],t=a(e,this.props.searchStr,this.state.selectedTabIndex);console.log("opening: ",t.toJS()),f.activateTab(e.tabWindow,t,this.state.selectedTabIndex,this.props.storeUpdateHandler)}},componentWillReceiveProps:function(e){var t=this.state.selectedWindowIndex,n=e.filteredWindows;if(t>=n.length)if(0===n.length)this.setState({selectedWindowIndex:0,selectedTabIndex:-1}),console.log("resetting indices");else{var s=n[n.length-1];this.setState({selectedWindowIndex:n.length-1,selectedTabIndex:r(this.props.searchStr,s)-1})}else{var o=n[t],a=Math.min(this.state.selectedTabIndex,r(this.props.searchStr,o)-1);this.setState({selectedTabIndex:a})}},render:function(){var e=this.props.winStore,t=e.countOpenTabs(),n=e.countOpenWindows(),s=e.countSavedWindows(),o="Tabs: "+t+" Open. Windows: "+n+" Open, "+s+" Saved.";return d.createElement("div",null,d.createElement("div",{style:p["default"].popupHeader},d.createElement(v["default"],{onSearchInput:this.props.onSearchInput,onSearchUp:this.handlePrevSelection,onSearchDown:this.handleNextSelection,onSearchEnter:this.handleSelectionEnter})),d.createElement("div",{style:p["default"].popupBody},d.createElement(b["default"],{winStore:this.props.winStore,storeUpdateHandler:this.props.storeUpdateHandler,filteredWindows:this.props.filteredWindows,appComponent:this.props.appComponent,searchStr:this.props.searchStr,searchRE:this.props.searchRE,selectedWindowIndex:this.state.selectedWindowIndex,selectedTabIndex:this.state.selectedTabIndex})),d.createElement("div",{style:p["default"].popupFooter},d.createElement("span",{style:u.merge(p["default"].closed,p["default"].summarySpan)},o)))}});t["default"]=S},181:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),a=o(r),i=n(182),d=s(i),l=n(187),p=s(l),c=a.createClass({displayName:"TabWindowList",render:function(){for(var e=[],t=[],n=[],s=this.props.filteredWindows,o=0;o<s.length;o++){var r=s[o],i=r.tabWindow,l="tabWindow"+o,c=i.open,u=i.focused,h=o===this.props.selectedWindowIndex,f=h?this.props.selectedTabIndex:-1,w=a.createElement(d["default"],{winStore:this.props.winStore,storeUpdateHandler:this.props.storeUpdateHandler,filteredTabWindow:r,key:l,searchStr:this.props.searchStr,searchRE:this.props.searchRE,isSelected:h,selectedTabIndex:f,appComponent:this.props.appComponent});u?e=w:c?t.push(w):n.push(w)}var v=null;return n.length>0&&(v=a.createElement(p["default"],{title:"Saved Closed Windows"},n)),a.createElement("div",null,a.createElement(p["default"],{title:"Current Window"},e),a.createElement(p["default"],{title:"Other Open Windows"},t),v)}});t["default"]=c},182:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),a=o(r),i=n(183),d=o(i),l=n(4),p=o(l),c=n(169),u=s(c),h=n(171),f=o(h),w=n(6),v=o(w),m=n(177),b=s(m),S=n(184),W=s(S),I=n(186),g=s(I),x=a.createClass({displayName:"FilteredTabWindow",mixins:[b["default"]],getInitialState:function(){return{expanded:null}},componentWillReceiveProps:function(e){e.isSelected&&!this.props.isSelected&&d.findDOMNode(this.refs.windowDiv).scrollIntoViewIfNeeded()},handleOpen:function(){console.log("handleOpen",this,this.props),v.openWindow(this.props.filteredTabWindow.tabWindow,this.props.storeUpdateHandler)},handleClose:function(e){v.closeWindow(this.props.filteredTabWindow.tabWindow,this.props.storeUpdateHandler)},handleRevert:function(e){var t=this.props.appComponent;t.openRevertModal(this.props.filteredTabWindow)},getExpandedState:function(){return null===this.state.expanded?this.props.filteredTabWindow.tabWindow.open:this.state.expanded},renderTabItems:function(e,t){for(var n=[],s=0;s<t.count();s++){var o="tabItem-"+s,r=s===this.props.selectedTabIndex,i=a.createElement(g["default"],{winStore:this.props.winStore,storeUpdateHandler:this.props.storeUpdateHandler,tabWindow:e,tab:t.get(s),key:o,tabIndex:s,isSelected:r,appComponent:this.props.appComponent});n.push(i)}var d=this.getExpandedState(),l=d?u["default"].expandablePanelContentOpen:u["default"].expandablePanelContentClosed,p=f.merge(u["default"].tabList,l);return a.createElement("div",{style:p},n)},handleExpand:function(e){this.setState({expanded:e})},render:function(){var e,t=this.props.filteredTabWindow,n=t.tabWindow;e=0===this.props.searchStr.length?n.tabItems:t.itemMatches.map(function(e){return e.tabItem});var s=this.getExpandedState(),o=null;o=s?this.renderTabItems(n,e):this.renderTabItems(n,p.Seq());var r=a.createElement(W["default"],{winStore:this.props.winStore,storeUpdateHandler:this.props.storeUpdateHandler,tabWindow:n,expanded:s,onExpand:this.handleExpand,onOpen:this.handleOpen,onRevert:this.handleRevert,onClose:this.handleClose,appComponent:this.props.appComponent}),i=this.props.isSelected?u["default"].tabWindowSelected:null,d=f.merge(u["default"].tabWindow,u["default"].expandablePanel,i);return a.createElement("div",{ref:"windowDiv",style:d,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},r,o)}});t["default"]=x}});